<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta
    http-equiv="Content-Security-Policy"
    content="
  default-src 'self';
  connect-src 'self' http://localhost:* http://127.0.0.1:* ws://localhost:* ws://127.0.0.1:*
   https://o4510364795469824.ingest.us.sentry.io wss://chatapp-xp.fun
   wss://www.chatapp-xp.fun wss://www.chatapp-xp.fun/ws https://chatapp-xp.fun https://www.chatapp-xp.fun;
  script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com https://browser.sentry-cdn.com;
  style-src 'self' 'unsafe-inline';
  img-src 'self' data: blob:;
  media-src 'self' blob: https://chatapp-xp.fun https://www.chatapp-xp.fun https://chatapp-attachments.tor1.cdn.digitaloceanspaces.com;
"
  />
  <title>ChatApp XP</title>
  <link rel="stylesheet" href="assets/css/main.css">
  <link rel="stylesheet" href="assets/css/create-channel.css">
  <link rel="stylesheet" href="assets/css/index.css">
  <link rel="stylesheet" href="assets/css/invitation-modal.css">
  <link rel="stylesheet" href="assets/css/notification-settings-modal.css">
  <link rel="stylesheet" href="assets/css/menu.css">
  <link rel="stylesheet" href="assets/css/e2ee-settings.css">
  <link rel="stylesheet" href="assets/css/e2ee-toggle.css">
  <link rel="stylesheet" href="assets/css/attachment.css">
  <link rel="stylesheet" href="assets/css/voice-message.css">
  <link rel="stylesheet" href="assets/css/mfa-settings-modal.css">
</head>
<body>
<!-- Window Title Bar -->
<div class="window-titlebar">
  <div class="titlebar-left">
    <div class="window-icon"></div>
    <span class="window-title" data-i18n="app.name">ChatApp XP</span>
  </div>
  <div class="titlebar-controls">
    <button class="titlebar-button minimize">_</button>
    <button class="titlebar-button maximize">□</button>
    <button class="titlebar-button close">×</button>
  </div>
</div>

<!-- Menu Bar -->
<div class="menu-bar">
  <div class="menu-item" data-i18n="menuTop.file">Fichier</div>
  <div class="menu-item" data-i18n="menuTop.settings">Paramètres</div>
  <div class="menu-item" data-i18n="menuTop.view">Affichage</div>
  <div class="menu-item" data-i18n="menuTop.tools">Outils</div>
  <div class="menu-item" data-i18n="menuTop.other">Autres</div>
</div>

<!-- Toolbar -->
<div class="toolbar">
  <button class="toolbar-button" id="disconnect">
    <div class="toolbar-icon disconnected"></div>
    <span data-i18n="toolbar.disconnect">Se Déconnecter</span>
  </button>
  <div class="toolbar-separator"></div>
  <button class="toolbar-button" id="new-channel">
    <div class="toolbar-icon new-channel"></div>
    <span data-i18n="toolbar.newChannel">Nouveau Salon</span>
  </button>
  <button class="toolbar-button" id="new-dm">
    <div class="toolbar-icon dm"></div>
    <span data-i18n="toolbar.newDm">Nouveau DM</span>
  </button>
  <button class="toolbar-button" id="receive-invite">
    <div class="toolbar-icon receive-invite"></div>
    <span data-i18n="buttons.invitations">Voir Invitations</span>
  </button>
  <button class="toolbar-button" id="user-stats-btn">
    <div class="toolbar-icon settings"></div>
    <span>Statistiques</span>
  </button>

</div>

<!-- Main Container -->
<div class="main-container">
  <!-- Left Sidebar -->
  <div class="sidebar-left">
    <div class="user-status-panel">
      <div class="user-avatar"></div>
      <div class="user-info">
        <div class="username" id="username"></div>
        <div id="user-status" class="user-status online" data-i18n="status.online">En ligne</div>
      </div>
      <div id="status-indicator" class="status-indicator online"></div>
    </div>

    <div class="channels-section">
      <div class="section-header">
        <div class="section-icon channels"></div>
        <span data-i18n="sidebar.channels">Salons</span>
      </div>
      <div class="channels-list" id="channels-list"></div>
    </div>

    <div class="dm-section">
      <div class="section-header">
        <div class="section-icon dm"></div>
        <span data-i18n="sidebar.privateMessages">Messages Privés</span>
      </div>
      <div id="dm-list" class="dm-list">
      </div>
    </div>
  </div>

  <!-- Chat Area -->
  <div class="chat-area">
    <div class="channel-header">
      <div class="channel-info">
        <div class="channel-icon" id="channel-icon"></div>
        <div class="channel-details">
          <div class="channel-name" id="channel-name"></div>
          <div class="channel-topic" id="channel-topic"></div>
        </div>
      </div>
    </div>

    <!-- Messages Container -->
    <div class="messages-container">
      <div class="typing-notification">
        <div class="typing-avatar"></div>
        <div class="typing-text"></div>
      </div>
      <div id="messages"></div>
    </div>

    <!-- Message Input Area -->
    <div class="message-input-area">
      <span id="typing-indicator"></span>
      <div class="input-container">
        <div class="attachment-container">
          <button class="attachment-button" title="Ajouter une pièce jointe ou un message vocal" data-i18n-title="chat.attachment.addAttachment">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
            </svg>
          </button>
          <div class="attachment-menu" style="display: none;">
            <div class="attachment-menu-item" data-action="voice">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"/>
                <path d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"/>
              </svg>
              <span data-i18n="chat.attachment.voiceMessage">Message vocal</span>
            </div>
            <div class="attachment-menu-item" data-action="file">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                <path d="M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5c0-1.38 1.12-2.5 2.5-2.5s2.5 1.12 2.5 2.5v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6h-1.5z"/>
              </svg>
              <span data-i18n="chat.attachment.file">Pièce jointe</span>
            </div>
          </div>
        </div>
                <div class="text-input-wrapper">
          <label>
            <input type="text" class="message-input" data-i18n="chat.placeholder" data-i18n-attr="placeholder" placeholder="Tapez votre message...">
          </label>
        </div>
        <button class="send-button" data-i18n="chat.send">Envoyer</button>
      </div>
    </div>
  </div>

  <!-- Right Sidebar -->
  <div class="sidebar-right">
    <div class="users-section">
      <div class="section-header">
        <div class="section-icon users"></div>
        <span data-i18n="sidebar.onlineUsers">Utilisateurs en ligne — </span><span id="online-users-count">0</span>
      </div>
      <div class="users-list">
      </div>
    </div>
  </div>
</div>

<!-- Status Bar -->
<div class="status-bar">
  <div class="status-section">
    <div id="network-status" class="network-status connected">
      <div class="network-icon"></div>
      <span id="network-text" data-i18n="status.connected">Connecté</span>
    </div>
  </div>
  <div class="status-section">
    <span id="current-time"></span>
  </div>
</div>

<!-- Scripts -->
<div class="notification-container"></div>

<!-- Apply i18n globally via module -->
<script type="module" src="src/lang/i18nDom.js"></script>

<script type="module" src="src/components/admin/adminPannel.js"></script>
<script src="https://browser.sentry-cdn.com/7.42.0/bundle.min.js" crossorigin="anonymous"></script>
<script>
  Sentry.init({
    dsn: 'https://3b235366f8b799f4332e7a696cc982ba@o4510364795469824.ingest.us.sentry.io/4510364826206208'
  });
  Sentry.setTag('platform', 'desktop');
</script>
<script type="module" src="./src/renderer.js"></script>
<script type="module" src="src/components/notifs/NotificationManager.js"></script>
<script type="module" src="src/components/chat/theme/ThemeManager.js"></script>
<script type="module" src="src/components/chat/gestionEtat/EtatManager.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.js"></script>
</body>
</html>
